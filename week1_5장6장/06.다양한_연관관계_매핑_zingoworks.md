# 6장 : 다양한 연관관계 매핑
1. 다대일
2. 일대다
3. 일대일 1:1
4. 다대다 N:N
5. 정리
실전예제 : 3. 다양한 연관관계 매핑

---

## 엔티티의 연관관계 매핑 시 고려해야할 사항
1. 다중성
2. 단방향, 양방향
3. 연관관계의 주인

#### 다중성
다대일, 일대다, 일대일, 다대다  
보통 다대일과 일대다 관계를 가장 많이 사용

#### 단방향, 양방향
테이블은 **외래 키** 하나로 **조인**을 사용해서 양방향으로 쿼리가 가능하므로 사실상 방향이라는 개념이 없다.  
반면에 객체는 **참조용 필드를 가지고 있는 객체만** 연관된 객체를 조회할 수 있다.

객체 관계에서 한 쪽만 참조하는 것을 단방향, 양쪽이 서로 참조하는 것을 양방향 관계라 한다

#### 연관관계의 주인
데이터베이스는 **외래 키** 하나로 두 테이블이 연관관계를 맺는다.  
따라서 테이블의 연관관계를 관리하는 포인트는 외래 키 `하나`다.  
반면 엔티티를 양방향으로 매핑하면 A -> B, B -> A 두 곳에서 **서로를 참조**한다  
따라서 객체의 연관관계를 관리하는 포인트는 `두 곳`이다

JPA는 두 객체의 연관관계 중 하나를 정해서 DB 외래 키를 관리하는데 이것을 연관관계의 주인이라 한다
* 일대다, 다대일에서는 항상 다(N)가 외래 키가 있다,  
즉 `다(N) 쪽이 주인 && 외래 키 가짐 && mappedBy 사용안함`
* 외래 키를 관리하는 곳이 연관관계의 주인
* 주인(외래키를 관리하는 곳)은 mappedBy 속성을 사용하지 않는다
* 주인이 아니면 mappedBy 속성을 사용하고 주인 필드 이름을 값으로 입력

---

### 다대일

#### 다대일 단방향 N:1

#### 다대일 양방향 N:1
* 양방향은 외래 키가 있는 쪽이 연관관계의 주인이다
* 양방향 연관관계는 항상 서로를 참조해야 한다

---

### 일대다

#### 일대다 단방향 1:N
* 단점 : 매핑한 객체가 관리하는 외래 키가 다른 테이블에 존재
* 일대다 단방향 매핑보다는 `다대일 양방향` 매핑을 사용하자

#### 일대다 양방향 1:N
* 일대다 양방향 매핑은 존재하지 않는다(왼쪽을 연관관계의 주인으로 가정)
* `다대일 양방향 매핑`을 사용해야 한다

---

### 일대일
* 특징  
    1. 일대일 관계는 그 반대도 일대일 관계다
    2. 테이블 관계에서 일대다, 다대일은 항상 다(N) 쪽이 외래 키를 가진다,  
    반면에 일대일 관계는 어느 곳이나 가질 수 있다
* 주 테이블에 외래 키
* 대상 테이블에 외래 키

#### 주 테이블에 외래 키
##### 단방향
##### 양방향
#### 대상 테이블에 외래 키    
##### 단방향
##### 양방향

---

### 다대다

#### 단방향
#### 양방향
#### 매핑의 한계와 극복, 연결 엔티티 사용
#### 새로운 기본 키 사용
#### 다대다 연관관계 정리